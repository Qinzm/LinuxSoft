RDS数据恢复到本地（官方）

#安装mysql5.6
rpm -ivh http://repo.mysql.com/mysql-community-release-el6-5.noarch.rpm && yum -y install mysql-server mysql

#下载阿里云的解压脚本
wget http://oss.aliyuncs.com/aliyunecs/rds_backup_extract.sh

#安装官方解压工具
wget https://www.percona.com/downloads/XtraBackup/Percona-XtraBackup-2.4.4/binary/tarball/percona-xtrabackup-2.4.4-Linux-x86_64.tar.gz
tar zxvf percona-xtrabackup-2.4.4-Linux-x86_64.tar.gz 
cp percona-xtrabackup-2.4.4-Linux-x86_64/bin/innobackupex /usr/local/bin/
innobackupex -v 

#下载备份文件并解压
mkdir -p /home/mysql/data
sh rds_backup_extract.sh -f /root/hins4377595_data_20180412164949.tar.gz -C /home/mysql/data

#解压
innobackupex --defaults-file=/home/mysql/data/backup-my.cnf --apply-log /home/mysql/data

#修改配置
vi /home/mysql/data/backup-my.cnf

注释掉5处
# This MySQL options file was generated by innobackupex.

# The MySQL server
[mysqld]
skip-grant
innodb_checksum_algorithm=innodb
#innodb_log_checksum_algorithm=innodb
innodb_data_file_path=ibdata1:200M:autoextend
innodb_log_files_in_group=2
innodb_log_file_size=524288000
#innodb_fast_checksum=false
innodb_page_size=16384
#innodb_log_block_size=512
innodb_undo_directory=.
innodb_undo_tablespaces=0
log-error=/home/mysql/data/error.log  
socket=/home/mysql/data/mysql.sock



#rds_encrypt_data=false
#innodb_encrypt_algorithm=aes_128_ecb

#修改权限
chown mysql:mysql -R /home/mysql/data


#启动服务
mysqld_safe --defaults-file=/home/mysql/data/backup-my.cnf --user=mysql --datadir=/home/mysql/data &

#登录改密码，删除重置密码
mysql -h127.0.0.1 –uroot 
mysql>delete from mysql.db where user<>’root’ and char_length(user)>0;delete from mysql.tables_priv where user<>’root’ and char_length(user)>0;flush privileges;
mysql>use mysql;
mysql>update user set password=password('123456') where user='root';
mysql>update user set host='%' where user='root' && host='127.0.0.1';
mysql>flush privileges;


#删除备库的数据
mysql>use mysql;
mysql>drop table slave_master_info;
mysql>drop table slave_relay_log_info;
mysql>drop table slave_worker_info;
mysql>drop table innodb_index_stats;
mysql>drop table innodb_table_stats;
mysql>source /usr/share/mysql/mysql_system_tables.sql
mysql>quit

https://m.aliyun.com/yunqi/articles/411081